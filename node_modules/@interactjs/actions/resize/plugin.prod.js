import*as e from"../../utils/domUtils.prod.js";import t from"../../utils/extend.prod.js";import r from"../../utils/is.prod.js";function i(t,i,s,o,n,a,l){if(!i)return!1;if(!0===i){const e=r.number(a.width)?a.width:a.right-a.left,i=r.number(a.height)?a.height:a.bottom-a.top;if(l=Math.min(l,Math.abs(("left"===t||"right"===t?e:i)/2)),e<0&&("left"===t?t="right":"right"===t&&(t="left")),i<0&&("top"===t?t="bottom":"bottom"===t&&(t="top")),"left"===t)return s.x<(e>=0?a.left:a.right)+l;if("top"===t)return s.y<(i>=0?a.top:a.bottom)+l;if("right"===t)return s.x>(e>=0?a.right:a.left)-l;if("bottom"===t)return s.y>(i>=0?a.bottom:a.top)-l}return!!r.element(o)&&(r.element(i)?i===o:e.matchesUpTo(o,i,n))}function s({iEvent:e,interaction:t}){if("resize"!==t.prepared.name||!t.resizeAxes)return;const r=e;t.interactable.options.resize.square?("y"===t.resizeAxes?r.delta.x=r.delta.y:r.delta.y=r.delta.x,r.axes="xy"):(r.axes=t.resizeAxes,"x"===t.resizeAxes?r.delta.y=0:"y"===t.resizeAxes&&(r.delta.x=0))}const o={id:"actions/resize",before:["actions/drag"],install(e){const{actions:t,browser:i,Interactable:s,defaults:n}=e;o.cursors=(e=>e.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"})(i),o.defaultMargin=i.supportsTouch||i.supportsPointerEvent?20:10,s.prototype.resizable=function(t){return((e,t,i)=>r.object(t)?(e.options.resize.enabled=!1!==t.enabled,e.setPerAction("resize",t),e.setOnEvents("resize",t),r.string(t.axis)&&/^x$|^y$|^xy$/.test(t.axis)?e.options.resize.axis=t.axis:null===t.axis&&(e.options.resize.axis=i.defaults.actions.resize.axis),r.bool(t.preserveAspectRatio)?e.options.resize.preserveAspectRatio=t.preserveAspectRatio:r.bool(t.square)&&(e.options.resize.square=t.square),e):r.bool(t)?(e.options.resize.enabled=t,e):e.options.resize)(this,t,e)},t.map.resize=o,t.methodDict.resize="resizable",n.actions.resize=o.defaults},listeners:{"interactions:new"({interaction:e}){e.resizeAxes="xy"},"interactions:action-start"(e){(({iEvent:e,interaction:r})=>{if("resize"!==r.prepared.name||!r.prepared.edges)return;const i=e,s=r.rect;r._rects={start:t({},s),corrected:t({},s),previous:t({},s),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},i.edges=r.prepared.edges,i.rect=r._rects.corrected,i.deltaRect=r._rects.delta})(e),s(e)},"interactions:action-move"(e){(({iEvent:e,interaction:r})=>{if("resize"!==r.prepared.name||!r.prepared.edges)return;const i=e,s=r.interactable.options.resize.invert,o="reposition"===s||"negate"===s,n=r.rect,{start:a,corrected:l,delta:p,previous:c}=r._rects;if(t(c,l),o){if(t(l,n),"reposition"===s){if(l.top>l.bottom){const e=l.top;l.top=l.bottom,l.bottom=e}if(l.left>l.right){const e=l.left;l.left=l.right,l.right=e}}}else l.top=Math.min(n.top,a.bottom),l.bottom=Math.max(n.bottom,a.top),l.left=Math.min(n.left,a.right),l.right=Math.max(n.right,a.left);l.width=l.right-l.left,l.height=l.bottom-l.top;for(const e in l)p[e]=l[e]-c[e];i.edges=r.prepared.edges,i.rect=l,i.deltaRect=p})(e),s(e)},"interactions:action-end"({iEvent:e,interaction:t}){if("resize"!==t.prepared.name||!t.prepared.edges)return;const r=e;r.edges=t.prepared.edges,r.rect=t._rects.corrected,r.deltaRect=t._rects.delta},"auto-start:check"(e){const{interaction:s,interactable:n,element:a,rect:l,buttons:p}=e;if(!l)return;const c=t({},s.coords.cur.page),d=n.options.resize;if(d&&d.enabled&&(!s.pointerIsDown||!/mouse|pointer/.test(s.pointerType)||0!=(p&d.mouseButtons))){if(r.object(d.edges)){const t={left:!1,right:!1,top:!1,bottom:!1};for(const e in t)t[e]=i(e,d.edges[e],c,s._latestPointer.eventTarget,a,l,d.margin||o.defaultMargin);t.left=t.left&&!t.right,t.top=t.top&&!t.bottom,(t.left||t.right||t.top||t.bottom)&&(e.action={name:"resize",edges:t})}else{const t="y"!==d.axis&&c.x>l.right-o.defaultMargin,r="x"!==d.axis&&c.y>l.bottom-o.defaultMargin;(t||r)&&(e.action={name:"resize",axes:(t?"x":"")+(r?"y":"")})}return!e.action&&void 0}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor({edges:e,axis:t,name:r}){const i=o.cursors;let s=null;if(t)s=i[r+t];else if(e){let t="";for(const r of["top","bottom","left","right"])e[r]&&(t+=r);s=i[t]}return s},defaultMargin:null};export default o;
//# sourceMappingURL=plugin.prod.js.map