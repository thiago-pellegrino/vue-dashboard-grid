import*as e from"../utils/arr.prod.js";import*as t from"../utils/domUtils.prod.js";import s from"../utils/extend.prod.js";import n from"../utils/is.prod.js";import r from"../utils/pointerExtend.prod.js";import*as o from"../utils/pointerUtils.prod.js";class i{constructor(e){this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=e,r(this,e)}preventOriginalDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}stopImmediatePropagation(){this.originalEvent.stopImmediatePropagation()}}function a(e){if(!n.object(e))return{capture:!!e,passive:!1};const t=s({},e);return t.capture=!!e.capture,t.passive=!!e.passive,t}export default{id:"events",install(s){var r;const p=[],l={},c=[],u={add:v,remove:d,addDelegate(t,s,n,r,o){const i=a(o);if(!l[n]){l[n]=[];for(const e of c)v(e,n,f),v(e,n,g,!0)}const p=l[n];let u=e.find(p,(e=>e.selector===t&&e.context===s));u||(u={selector:t,context:s,listeners:[]},p.push(u)),u.listeners.push([r,i])},removeDelegate(e,t,s,n,r){const o=a(r),i=l[s];let p,c=!1;if(i)for(p=i.length-1;p>=0;p--){const r=i[p];if(r.selector===e&&r.context===t){const{listeners:e}=r;for(let r=e.length-1;r>=0;r--){const[a,{capture:l,passive:u}]=e[r];if(a===n&&l===o.capture&&u===o.passive){e.splice(r,1),e.length||(i.splice(p,1),d(t,s,f),d(t,s,g,!0)),c=!0;break}}if(c)break}}},delegateListener:f,delegateUseCapture:g,delegatedEvents:l,documents:c,targets:p,supportsOptions:!1,supportsPassive:!1};function v(t,s,n,r){const o=a(r);let i=e.find(p,(e=>e.eventTarget===t));i||(i={eventTarget:t,events:{}},p.push(i)),i.events[s]||(i.events[s]=[]),t.addEventListener&&!e.contains(i.events[s],n)&&(t.addEventListener(s,n,u.supportsOptions?o:o.capture),i.events[s].push(n))}function d(t,s,n,r){const o=a(r),i=e.findIndex(p,(e=>e.eventTarget===t)),l=p[i];if(!l||!l.events)return;if("all"===s){for(s in l.events)l.events.hasOwnProperty(s)&&d(t,s,"all");return}let c=!1;const v=l.events[s];if(v){if("all"===n){for(let e=v.length-1;e>=0;e--)d(t,s,v[e],o);return}for(let e=0;e<v.length;e++)if(v[e]===n){t.removeEventListener(s,n,u.supportsOptions?o:o.capture),v.splice(e,1),0===v.length&&(delete l.events[s],c=!0);break}}c&&!Object.keys(l.events).length&&p.splice(i,1)}function f(e,s){const r=a(s),p=new i(e),c=l[e.type],[u]=o.getEventTargets(e);let v=u;for(;n.element(v);){for(let e=0;e<c.length;e++){const s=c[e],{selector:n,context:o}=s;if(t.matchesSelector(v,n)&&t.nodeContains(o,u)&&t.nodeContains(o,v)){const{listeners:e}=s;p.currentTarget=v;for(const[t,{capture:s,passive:n}]of e)s===r.capture&&n===r.passive&&t(p)}}v=t.parentNode(v)}}function g(e){return f(e,!0)}return null==(r=s.document)||r.createElement("div").addEventListener("test",null,{get capture(){return u.supportsOptions=!0},get passive(){return u.supportsPassive=!0}}),s.events=u,u}};
//# sourceMappingURL=events.prod.js.map