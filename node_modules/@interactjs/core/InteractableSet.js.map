{
	"version": 3,
	"sources": [
		"InteractableSet.ts"
	],
	"names": [
		"arr",
		"domUtils",
		"extend",
		"is",
		"InteractableSet",
		"constructor",
		"scope",
		"list",
		"selectorMap",
		"addListeners",
		"interactable",
		"target",
		"_context",
		"context",
		"targetMappings",
		"string",
		"id",
		"targetIndex",
		"findIndex",
		"m",
		"splice",
		"new",
		"options",
		"actions",
		"Interactable",
		"document",
		"events",
		"mappingInfo",
		"addDocument",
		"_doc",
		"push",
		"Object",
		"defineProperty",
		"value",
		"configurable",
		"fire",
		"win",
		"_win",
		"get",
		"isSelector",
		"found",
		"find",
		"inContext",
		"forEachMatch",
		"node",
		"callback",
		"ret",
		"element",
		"matchesSelector",
		"undefined"
	],
	"mappings": "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",
	"sourcesContent": [
		"import type { Interactable } from '@interactjs/core/Interactable'\nimport type { OptionsArg, Options } from '@interactjs/core/options'\nimport type { Scope } from '@interactjs/core/scope'\nimport type { Target, Context } from '@interactjs/types/index'\nimport * as arr from '@interactjs/utils/arr'\nimport * as domUtils from '@interactjs/utils/domUtils'\nimport extend from '@interactjs/utils/extend'\nimport is from '@interactjs/utils/is'\n\ndeclare module '@interactjs/core/scope' {\n  interface SignalArgs {\n    'interactable:new': {\n      interactable: Interactable\n      target: Target\n      options: OptionsArg\n      win: Window\n    }\n  }\n}\n\ninterface InteractableScopeProp {\n  context: Context\n  interactable: Interactable\n}\n\nexport class InteractableSet {\n  // all set interactables\n  list: Interactable[] = []\n\n  selectorMap: {\n    [selector: string]: InteractableScopeProp[]\n  } = {}\n\n  scope: Scope\n\n  constructor (scope: Scope) {\n    this.scope = scope\n    scope.addListeners({\n      'interactable:unset': ({ interactable }) => {\n        const { target, _context: context } = interactable\n        const targetMappings: InteractableScopeProp[] = is.string(target)\n          ? this.selectorMap[target]\n          : (target as any)[this.scope.id]\n\n        const targetIndex = arr.findIndex(targetMappings, (m) => m.context === context)\n        if (targetMappings[targetIndex]) {\n          // Destroying mappingInfo's context and interactable\n          targetMappings[targetIndex].context = null\n          targetMappings[targetIndex].interactable = null\n        }\n        targetMappings.splice(targetIndex, 1)\n      },\n    })\n  }\n\n  new (target: Target, options?: any): Interactable {\n    options = extend(options || {}, {\n      actions: this.scope.actions,\n    })\n    const interactable = new this.scope.Interactable(target, options, this.scope.document, this.scope.events)\n    const mappingInfo = { context: interactable._context, interactable }\n\n    this.scope.addDocument(interactable._doc)\n    this.list.push(interactable)\n\n    if (is.string(target)) {\n      if (!this.selectorMap[target]) {\n        this.selectorMap[target] = []\n      }\n      this.selectorMap[target].push(mappingInfo)\n    } else {\n      if (!(interactable.target as any)[this.scope.id]) {\n        Object.defineProperty(target, this.scope.id, {\n          value: [],\n          configurable: true,\n        })\n      }\n\n      ;(target as any)[this.scope.id].push(mappingInfo)\n    }\n\n    this.scope.fire('interactable:new', {\n      target,\n      options,\n      interactable,\n      win: this.scope._win,\n    })\n\n    return interactable\n  }\n\n  get (target: Target, options?: Options) {\n    const context = (options && options.context) || this.scope.document\n    const isSelector = is.string(target)\n    const targetMappings: InteractableScopeProp[] = isSelector\n      ? this.selectorMap[target as string]\n      : (target as any)[this.scope.id]\n\n    if (!targetMappings) {\n      return null\n    }\n\n    const found = arr.find(\n      targetMappings,\n      (m) => m.context === context && (isSelector || m.interactable.inContext(target as any)),\n    )\n\n    return found && found.interactable\n  }\n\n  forEachMatch<T> (node: Node, callback: (interactable: Interactable) => T) {\n    for (const interactable of this.list) {\n      let ret: void | T\n\n      if (\n        (is.string(interactable.target)\n          ? // target is a selector and the element matches\n          is.element(node) && domUtils.matchesSelector(node, interactable.target)\n          : // target is the element\n          node === interactable.target) &&\n        // the element is in context\n        interactable.inContext(node)\n      ) {\n        ret = callback(interactable)\n      }\n\n      if (ret !== undefined) {\n        return ret\n      }\n    }\n  }\n}\n"
	]
}